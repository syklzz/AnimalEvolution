-- if DB_ID('db_restaurant') is not null
--     drop database db_restaurant
-- go
--
-- create database db_restaurant
-- go
if object_id('TableDetails','U') is not null
    drop table TableDetails
if object_id('Tables','U') is not null
    drop table Tables
if object_id('Reservations','U') is not null
    drop table Reservations
if object_id('ReservationRules','U') is not null
    drop table ReservationRules
if object_id('OrderDetails','U') is not null
    drop table OrderDetails
if object_id('MenuItems','U') is not null
    drop table MenuItems
if object_id('Ingredients','U') is not null
    drop table Ingredients
if object_id('Orders','U') is not null
    drop table Orders
if object_id('CustomersDiscounts','U') is not null
    drop table CustomersDiscounts
if object_id('Discounts','U') is not null
    drop table Discounts
if object_id('Customers','U') is not null
    drop table Customers
if object_id('Corporations','U') is not null
    drop table Corporations
if object_id('Invoice','U') is not null
    drop table Invoice

create table Invoice(
    InvoiceID int not null primary key,
    NIP int not null,
    Price decimal(7,2) not null,
    DiscountID int -- czy to jest tu potrzebne? chyba nie bo wystarczy zrobic duzego joina do Discounts
)

create table Corporations(
    CorporationID int not null primary key,
    CorporationName varchar(50) not null,
    RepresentativeID int not null,
    InvoiceID int foreign key references Invoice(InvoiceID)
)

create table Customers(
    CustomerID int not null primary key,
    FirstName varchar(20) not null,
    LastName varchar(30) not null,
    CorporationID int foreign key references Corporations(CorporationID)
)

create table Discounts(
    DiscountID int not null primary key,
    Type varchar(20), --??????
    Value decimal(5,2),
    Description varchar(100)
)

create table CustomersDiscounts(
    CustomerID int not null primary key foreign key references Customers(CustomerID),
    DiscountID int foreign key references Discounts(DiscountID)
)

create table Orders(
    -- bez restaurantID bo to chyba niepotrzebne?
    OrderID int not null primary key,
    CustomerID int foreign key references Customers(CustomerID),
    DiscountID int foreign key references Discounts(DiscountID), -- wydaje mi się że to połączenie jest niepotrzebne i wystarczy jak DiscountID bedzie połączone CustomerDiscounts a to z Customers
    DateOfBooking datetime not null,
    Price decimal(7,2)
)

create table Ingredients(
    IngredientID int not null primary key,
    Quantity int not null
)

create table MenuItems(
    ItemID int not null primary key,
    AppearDate datetime,
    DeletionDate datetime,
    IngredientID int foreign key references Ingredients(IngredientID),
    IsOnMenu bit, -- taki boolean
    IsSeaFood bit,
    Availability bit
)

create table OrderDetails(
    OrderID int not null primary key foreign key references Orders(OrderID),
    ItemID int not null foreign key references MenuItems(ItemID)
)

create table ReservationRules( --??????
    RuleID int not null primary key,
    Type varchar(30),
    Description varchar (100)
)

create table Reservations(
    ReservationID int not null primary key,
    OrderID int not null foreign key references Orders(OrderID),
    PaymentType varchar(20),
    RuleID int foreign key references ReservationRules(RuleID)
)

create table Tables(
    TableID int not null primary key,
    Availability bit
)

create table TableDetails(
    TableID int not null primary key foreign key references Tables(TableID),
    ReservationID int foreign key references Reservations(ReservationID)

)



